/**
 * skylark-threegltfviewer - A version of threegltfviewer that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-threegltfviewer/
 * @license MIT
 */
!function(t,n){var i=n.define,require=n.require,r="function"==typeof i&&i.amd,a=!r&&"undefined"!=typeof exports;if(!r&&!i){var s={};i=n.define=function(e,t,n){"function"==typeof n?(s[e]={factory:n,deps:t.map(function(t){return function(e,t){if("."!==e[0])return e;var n=t.split("/"),i=e.split("/");n.pop();for(var r=0;r<i.length;r++)"."!=i[r]&&(".."==i[r]?n.pop():n.push(i[r]));return n.join("/")}(t,e)}),resolved:!1,exports:null},require(e)):s[e]={factory:null,resolved:!0,exports:n}},require=n.require=function(e){if(!s.hasOwnProperty(e))throw new Error("Module "+e+" has not been defined");var module=s[e];if(!module.resolved){var t=[];module.deps.forEach(function(e){t.push(require(e))}),module.exports=module.factory.apply(n,t)||null,module.resolved=!0}return module.exports}}if(!i)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(t,require){t("skylark-threegltfviewer/threegltviewer",["skylark-langx-ns"],function(e){return e.attach("intg.threegltviewer",{})}),t("skylark-threejs-ex/WebGL",[],function(){"use strict";var e={isWebGLAvailable:function(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(e){return!1}},isWebGL2Available:function(){try{var e=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!e.getContext("webgl2"))}catch(e){return!1}},getWebGLErrorMessage:function(){return this.getErrorMessage(1)},getWebGL2ErrorMessage:function(){return this.getErrorMessage(2)},getErrorMessage:function(e){var t={1:window.WebGLRenderingContext,2:window.WebGL2RenderingContext},n='Your $0 does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">$1</a>',i=document.createElement("div");return i.id="webglmessage",i.style.fontFamily="monospace",i.style.fontSize="13px",i.style.fontWeight="normal",i.style.textAlign="center",i.style.background="#fff",i.style.color="#000",i.style.padding="1.5em",i.style.width="400px",i.style.margin="5em auto 0",n=(n=t[e]?n.replace("$0","graphics card"):n.replace("$0","browser")).replace("$1",{1:"WebGL",2:"WebGL 2"}[e]),i.innerHTML=n,i}};return e}),t("skylark-threejs-ex/utils/stats",[],function(){var e=function(){var t=0,n=document.createElement("div");function i(e){return n.appendChild(e.dom),e}function r(e){for(var i=0;i<n.children.length;i++)n.children[i].style.display=i===e?"block":"none";t=e}n.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",n.addEventListener("click",function(e){e.preventDefault(),r(++t%n.children.length)},!1);var a=(performance||Date).now(),s=a,o=0,l=i(new e.Panel("FPS","#0ff","#002")),c=i(new e.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var h=i(new e.Panel("MB","#f08","#201"));return r(0),{REVISION:16,dom:n,addPanel:i,showPanel:r,begin:function(){a=(performance||Date).now()},end:function(){o++;var e=(performance||Date).now();if(c.update(e-a,200),e>=s+1e3&&(l.update(1e3*o/(e-s),100),s=e,o=0,h)){var t=performance.memory;h.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){a=this.end()},domElement:n,setMode:r}};return e.Panel=function(e,t,n){var i=1/0,r=0,a=Math.round,s=a(window.devicePixelRatio||1),o=80*s,l=48*s,c=3*s,h=2*s,d=3*s,p=15*s,m=74*s,u=30*s,f=document.createElement("canvas");f.width=o,f.height=l,f.style.cssText="width:80px;height:48px";var g=f.getContext("2d");return g.font="bold "+9*s+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=n,g.fillRect(0,0,o,l),g.fillStyle=t,g.fillText(e,c,h),g.fillRect(d,p,m,u),g.fillStyle=n,g.globalAlpha=.9,g.fillRect(d,p,m,u),{dom:f,update:function(l,v){i=Math.min(i,l),r=Math.max(r,l),g.fillStyle=n,g.globalAlpha=1,g.fillRect(0,0,o,p),g.fillStyle=t,g.fillText(a(l)+" "+e+" ("+a(i)+"-"+a(r)+")",c,h),g.drawImage(f,d+s,p,m-s,u,d,p,m-s,u),g.fillRect(d+m-s,p,s,u),g.fillStyle=n,g.globalAlpha=.9,g.fillRect(d+m-s,p,s,a((1-l/v)*u))}}},e}),t("skylark-threejs-ex/controls/OrbitControls",["skylark-threejs"],function(e){"use strict";var t=function(t,n){var i,r,a,s,o;void 0===n&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),n===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=t,this.domElement=n,this.enabled=!0,this.target=new e.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:e.MOUSE.ROTATE,MIDDLE:e.MOUSE.DOLLY,RIGHT:e.MOUSE.PAN},this.touches={ONE:e.TOUCH.ROTATE,TWO:e.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return f.phi},this.getAzimuthalAngle=function(){return f.theta},this.saveState=function(){l.target0.copy(l.target),l.position0.copy(l.object.position),l.zoom0=l.object.zoom},this.reset=function(){l.target.copy(l.target0),l.object.position.copy(l.position0),l.object.zoom=l.zoom0,l.object.updateProjectionMatrix(),l.dispatchEvent(c),l.update(),m=p.NONE},this.update=(i=new e.Vector3,r=(new e.Quaternion).setFromUnitVectors(t.up,new e.Vector3(0,1,0)),a=r.clone().inverse(),s=new e.Vector3,o=new e.Quaternion,function(){var e=l.object.position;return i.copy(e).sub(l.target),i.applyQuaternion(r),f.setFromVector3(i),l.autoRotate&&m===p.NONE&&O(2*Math.PI/60/60*l.autoRotateSpeed),l.enableDamping?(f.theta+=g.theta*l.dampingFactor,f.phi+=g.phi*l.dampingFactor):(f.theta+=g.theta,f.phi+=g.phi),f.theta=Math.max(l.minAzimuthAngle,Math.min(l.maxAzimuthAngle,f.theta)),f.phi=Math.max(l.minPolarAngle,Math.min(l.maxPolarAngle,f.phi)),f.makeSafe(),f.radius*=v,f.radius=Math.max(l.minDistance,Math.min(l.maxDistance,f.radius)),!0===l.enableDamping?l.target.addScaledVector(y,l.dampingFactor):l.target.add(y),i.setFromSpherical(f),i.applyQuaternion(a),e.copy(l.target).add(i),l.object.lookAt(l.target),!0===l.enableDamping?(g.theta*=1-l.dampingFactor,g.phi*=1-l.dampingFactor,y.multiplyScalar(1-l.dampingFactor)):(g.set(0,0,0),y.set(0,0,0)),v=1,!!(b||s.distanceToSquared(l.object.position)>u||8*(1-o.dot(l.object.quaternion))>u)&&(l.dispatchEvent(c),s.copy(l.object.position),o.copy(l.object.quaternion),b=!1,!0)}),this.dispose=function(){l.domElement.removeEventListener("contextmenu",ee,!1),l.domElement.removeEventListener("mousedown",W,!1),l.domElement.removeEventListener("wheel",X,!1),l.domElement.removeEventListener("touchstart",K,!1),l.domElement.removeEventListener("touchend",J,!1),l.domElement.removeEventListener("touchmove",Q,!1),document.removeEventListener("mousemove",Z,!1),document.removeEventListener("mouseup",q,!1),l.domElement.removeEventListener("keydown",$,!1)};var l=this,c={type:"change"},h={type:"start"},d={type:"end"},p={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},m=p.NONE,u=1e-6,f=new e.Spherical,g=new e.Spherical,v=1,y=new e.Vector3,b=!1,E=new e.Vector2,w=new e.Vector2,x=new e.Vector2,C=new e.Vector2,k=new e.Vector2,L=new e.Vector2,T=new e.Vector2,S=new e.Vector2,A=new e.Vector2;function R(){return Math.pow(.95,l.zoomSpeed)}function O(e){g.theta-=e}function P(e){g.phi-=e}var M,D=(M=new e.Vector3,function(e,t){M.setFromMatrixColumn(t,0),M.multiplyScalar(-e),y.add(M)}),j=function(){var t=new e.Vector3;return function(e,n){!0===l.screenSpacePanning?t.setFromMatrixColumn(n,1):(t.setFromMatrixColumn(n,0),t.crossVectors(l.object.up,t)),t.multiplyScalar(e),y.add(t)}}(),F=function(){var t=new e.Vector3;return function(e,n){var i=l.domElement;if(l.object.isPerspectiveCamera){var r=l.object.position;t.copy(r).sub(l.target);var a=t.length();a*=Math.tan(l.object.fov/2*Math.PI/180),D(2*e*a/i.clientHeight,l.object.matrix),j(2*n*a/i.clientHeight,l.object.matrix)}else l.object.isOrthographicCamera?(D(e*(l.object.right-l.object.left)/l.object.zoom/i.clientWidth,l.object.matrix),j(n*(l.object.top-l.object.bottom)/l.object.zoom/i.clientHeight,l.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),l.enablePan=!1)}}();function _(e){l.object.isPerspectiveCamera?v/=e:l.object.isOrthographicCamera?(l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom*e)),l.object.updateProjectionMatrix(),b=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),l.enableZoom=!1)}function H(e){l.object.isPerspectiveCamera?v*=e:l.object.isOrthographicCamera?(l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom/e)),l.object.updateProjectionMatrix(),b=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),l.enableZoom=!1)}function U(e){E.set(e.clientX,e.clientY)}function N(e){C.set(e.clientX,e.clientY)}function G(e){if(1==e.touches.length)E.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);E.set(t,n)}}function z(e){if(1==e.touches.length)C.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);C.set(t,n)}}function I(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,i=Math.sqrt(t*t+n*n);T.set(0,i)}function V(e){if(1==e.touches.length)w.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);w.set(t,n)}x.subVectors(w,E).multiplyScalar(l.rotateSpeed);var i=l.domElement;O(2*Math.PI*x.x/i.clientHeight),P(2*Math.PI*x.y/i.clientHeight),E.copy(w)}function B(e){if(1==e.touches.length)k.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);k.set(t,n)}L.subVectors(k,C).multiplyScalar(l.panSpeed),F(L.x,L.y),C.copy(k)}function Y(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,i=Math.sqrt(t*t+n*n);S.set(0,i),A.set(0,Math.pow(S.y/T.y,l.zoomSpeed)),_(A.y),T.copy(S)}function W(t){if(!1!==l.enabled){var n;switch(t.preventDefault(),l.domElement.focus?l.domElement.focus():window.focus(),t.button){case 0:n=l.mouseButtons.LEFT;break;case 1:n=l.mouseButtons.MIDDLE;break;case 2:n=l.mouseButtons.RIGHT;break;default:n=-1}switch(n){case e.MOUSE.DOLLY:if(!1===l.enableZoom)return;!function(e){T.set(e.clientX,e.clientY)}(t),m=p.DOLLY;break;case e.MOUSE.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===l.enablePan)return;N(t),m=p.PAN}else{if(!1===l.enableRotate)return;U(t),m=p.ROTATE}break;case e.MOUSE.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===l.enableRotate)return;U(t),m=p.ROTATE}else{if(!1===l.enablePan)return;N(t),m=p.PAN}break;default:m=p.NONE}m!==p.NONE&&(document.addEventListener("mousemove",Z,!1),document.addEventListener("mouseup",q,!1),l.dispatchEvent(h))}}function Z(e){if(!1!==l.enabled)switch(e.preventDefault(),m){case p.ROTATE:if(!1===l.enableRotate)return;!function(e){w.set(e.clientX,e.clientY),x.subVectors(w,E).multiplyScalar(l.rotateSpeed);var t=l.domElement;O(2*Math.PI*x.x/t.clientHeight),P(2*Math.PI*x.y/t.clientHeight),E.copy(w),l.update()}(e);break;case p.DOLLY:if(!1===l.enableZoom)return;!function(e){S.set(e.clientX,e.clientY),A.subVectors(S,T),A.y>0?_(R()):A.y<0&&H(R());T.copy(S),l.update()}(e);break;case p.PAN:if(!1===l.enablePan)return;!function(e){k.set(e.clientX,e.clientY),L.subVectors(k,C).multiplyScalar(l.panSpeed),F(L.x,L.y),C.copy(k),l.update()}(e)}}function q(e){!1!==l.enabled&&(document.removeEventListener("mousemove",Z,!1),document.removeEventListener("mouseup",q,!1),l.dispatchEvent(d),m=p.NONE)}function X(e){!1===l.enabled||!1===l.enableZoom||m!==p.NONE&&m!==p.ROTATE||(e.preventDefault(),e.stopPropagation(),l.dispatchEvent(h),function(e){e.deltaY<0?H(R()):e.deltaY>0&&_(R());l.update()}(e),l.dispatchEvent(d))}function $(e){!1!==l.enabled&&!1!==l.enableKeys&&!1!==l.enablePan&&function(e){var t=!1;switch(e.keyCode){case l.keys.UP:F(0,l.keyPanSpeed),t=!0;break;case l.keys.BOTTOM:F(0,-l.keyPanSpeed),t=!0;break;case l.keys.LEFT:F(l.keyPanSpeed,0),t=!0;break;case l.keys.RIGHT:F(-l.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),l.update())}(e)}function K(t){if(!1!==l.enabled){switch(t.preventDefault(),t.touches.length){case 1:switch(l.touches.ONE){case e.TOUCH.ROTATE:if(!1===l.enableRotate)return;G(t),m=p.TOUCH_ROTATE;break;case e.TOUCH.PAN:if(!1===l.enablePan)return;z(t),m=p.TOUCH_PAN;break;default:m=p.NONE}break;case 2:switch(l.touches.TWO){case e.TOUCH.DOLLY_PAN:if(!1===l.enableZoom&&!1===l.enablePan)return;!function(e){l.enableZoom&&I(e);l.enablePan&&z(e)}(t),m=p.TOUCH_DOLLY_PAN;break;case e.TOUCH.DOLLY_ROTATE:if(!1===l.enableZoom&&!1===l.enableRotate)return;!function(e){l.enableZoom&&I(e);l.enableRotate&&G(e)}(t),m=p.TOUCH_DOLLY_ROTATE;break;default:m=p.NONE}break;default:m=p.NONE}m!==p.NONE&&l.dispatchEvent(h)}}function Q(e){if(!1!==l.enabled)switch(e.preventDefault(),e.stopPropagation(),m){case p.TOUCH_ROTATE:if(!1===l.enableRotate)return;V(e),l.update();break;case p.TOUCH_PAN:if(!1===l.enablePan)return;B(e),l.update();break;case p.TOUCH_DOLLY_PAN:if(!1===l.enableZoom&&!1===l.enablePan)return;!function(e){l.enableZoom&&Y(e);l.enablePan&&B(e)}(e),l.update();break;case p.TOUCH_DOLLY_ROTATE:if(!1===l.enableZoom&&!1===l.enableRotate)return;!function(e){l.enableZoom&&Y(e);l.enableRotate&&V(e)}(e),l.update();break;default:m=p.NONE}}function J(e){!1!==l.enabled&&(l.dispatchEvent(d),m=p.NONE)}function ee(e){!1!==l.enabled&&e.preventDefault()}l.domElement.addEventListener("contextmenu",ee,!1),l.domElement.addEventListener("mousedown",W,!1),l.domElement.addEventListener("wheel",X,!1),l.domElement.addEventListener("touchstart",K,!1),l.domElement.addEventListener("touchend",J,!1),l.domElement.addEventListener("touchmove",Q,!1),l.domElement.addEventListener("keydown",$,!1),-1===l.domElement.tabIndex&&(l.domElement.tabIndex=0),this.update()};return(t.prototype=Object.create(e.EventDispatcher.prototype)).constructor=t,t}),t("skylark-threejs-ex/loaders/RGBELoader",["skylark-threejs"],function(e){"use strict";var t=function(t){e.DataTextureLoader.call(this,t),this.type=e.UnsignedByteType};return t.prototype=Object.assign(Object.create(e.DataTextureLoader.prototype),{constructor:t,parse:function(t){var n=function(e,t){switch(e){case 1:console.error("RGBELoader Read Error: "+(t||""));break;case 2:console.error("RGBELoader Write Error: "+(t||""));break;case 3:console.error("RGBELoader Bad File Format: "+(t||""));break;default:case 4:console.error("RGBELoader: Error: "+(t||""))}return-1},i=function(e,t,n){t=t||1024;for(var i=e.pos,r=-1,a=0,s="",o=String.fromCharCode.apply(null,new Uint16Array(e.subarray(i,i+128)));0>(r=o.indexOf("\n"))&&a<t&&i<e.byteLength;)s+=o,a+=o.length,i+=128,o+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(i,i+128)));return-1<r&&(!1!==n&&(e.pos+=a+r+1),s+o.slice(0,r))},r=function(e,t,n,i){var r=e[t+3],a=Math.pow(2,r-128)/255;n[i+0]=e[t+0]*a,n[i+1]=e[t+1]*a,n[i+2]=e[t+2]*a},a=function(){var e=new Float32Array(1),t=new Int32Array(e.buffer);function n(n){e[0]=n;var i=t[0],r=i>>16&32768,a=i>>12&2047,s=i>>23&255;return s<103?r:s>142?(r|=31744,r|=(255==s?0:1)&&8388607&i):s<113?r|=((a|=2048)>>114-s)+(a>>113-s&1):(r|=s-112<<10|a>>1,r+=1&a)}return function(e,t,i,r){var a=e[t+3],s=Math.pow(2,a-128)/255;i[r+0]=n(e[t+0]*s),i[r+1]=n(e[t+1]*s),i[r+2]=n(e[t+2]*s)}}(),s=new Uint8Array(t);s.pos=0;var o=function(e){var t,r,a=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,o=/^\s*FORMAT=(\S+)\s*$/,l=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,c={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(e.pos>=e.byteLength||!(t=i(e)))return n(1,"no header found");if(!(r=t.match(/^#\?(\S+)$/)))return n(3,"bad initial token");c.valid|=1,c.programtype=r[1],c.string+=t+"\n";for(;!1!==(t=i(e));)if(c.string+=t+"\n","#"!==t.charAt(0)){if((r=t.match(a))&&(c.gamma=parseFloat(r[1],10)),(r=t.match(s))&&(c.exposure=parseFloat(r[1],10)),(r=t.match(o))&&(c.valid|=2,c.format=r[1]),(r=t.match(l))&&(c.valid|=4,c.height=parseInt(r[1],10),c.width=parseInt(r[2],10)),2&c.valid&&4&c.valid)break}else c.comments+=t+"\n";if(!(2&c.valid))return n(3,"missing format specifier");if(!(4&c.valid))return n(3,"missing image size specifier");return c}(s);if(-1!==o){var l=o.width,c=o.height,h=function(e,t,i){var r,a,s,o,l,c,h,d,p,m,u,f,g,v=t,y=i;if(v<8||v>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);if(v!==(e[2]<<8|e[3]))return n(3,"wrong scanline width");if(!(r=new Uint8Array(4*t*i))||!r.length)return n(4,"unable to allocate buffer space");a=0,s=0,d=4*v,g=new Uint8Array(4),c=new Uint8Array(d);for(;y>0&&s<e.byteLength;){if(s+4>e.byteLength)return n(1);if(g[0]=e[s++],g[1]=e[s++],g[2]=e[s++],g[3]=e[s++],2!=g[0]||2!=g[1]||(g[2]<<8|g[3])!=v)return n(3,"bad rgbe scanline format");for(h=0;h<d&&s<e.byteLength;){if(o=e[s++],(f=o>128)&&(o-=128),0===o||h+o>d)return n(3,"bad scanline data");if(f)for(l=e[s++],p=0;p<o;p++)c[h++]=l;else c.set(e.subarray(s,s+o),h),h+=o,s+=o}for(m=v,p=0;p<m;p++)u=0,r[a]=c[p+u],u+=v,r[a+1]=c[p+u],u+=v,r[a+2]=c[p+u],u+=v,r[a+3]=c[p+u],a+=4;y--}return r}(s.subarray(s.pos),l,c);if(-1!==h){switch(this.type){case e.UnsignedByteType:var d=h,p=e.RGBEFormat,m=e.UnsignedByteType;break;case e.FloatType:for(var u=h.length/4*3,f=new Float32Array(u),g=0;g<u;g++)r(h,4*g,f,3*g);var d=f,p=e.RGBFormat,m=e.FloatType;break;case e.HalfFloatType:for(var u=h.length/4*3,v=new Uint16Array(u),g=0;g<u;g++)a(h,4*g,v,3*g);var d=v,p=e.RGBFormat,m=e.HalfFloatType;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:l,height:c,data:d,header:o.string,gamma:o.gamma,exposure:o.exposure,format:p,type:m}}}return null},setDataType:function(e){return this.type=e,this},load:function(t,n,i,r){return e.DataTextureLoader.prototype.load.call(this,t,function(t,i){switch(t.type){case e.UnsignedByteType:t.encoding=e.RGBEEncoding,t.minFilter=e.NearestFilter,t.magFilter=e.NearestFilter,t.generateMipmaps=!1,t.flipY=!0;break;case e.FloatType:case e.HalfFloatType:t.encoding=e.LinearEncoding,t.minFilter=e.LinearFilter,t.magFilter=e.LinearFilter,t.generateMipmaps=!1,t.flipY=!0}n&&n(t,i)},i,r)}}),t}),t("skylark-threegltfviewer/environments",["./threegltviewer"],function(e){return e.environments=[{id:"",name:"None",path:null,format:".hdr"},{id:"venice-sunset",name:"Venice Sunset",path:"assets/environment/venice_sunset_1k.hdr",format:".hdr"},{id:"footprint-court",name:"Footprint Court (HDR Labs)",path:"assets/environment/footprint_court_2k.hdr",format:".hdr"}]}),t("skylark-threegltfviewer/vignettes",["skylark-threejs","./threegltviewer"],function(e,t){"use strict";const n=["attribute vec3 position;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","varying vec2 vUv;","void main() {","\tgl_Position = vec4(position, 1.0);","\tvUv = vec2(position.x, position.y) * 0.5 + 0.5;","}"].join("\n"),i=["precision mediump float;","#pragma glslify: grain = require('glsl-film-grain')","#pragma glslify: blend = require('glsl-blend-soft-light')","","uniform vec3 color1;","uniform vec3 color2;","uniform float aspect;","uniform vec2 offset;","uniform vec2 scale;","uniform float noiseAlpha;","uniform bool aspectCorrection;","uniform float grainScale;","uniform float grainTime;","uniform vec2 smooth;","","varying vec2 vUv;","","void main() {","\tvec2 q = vec2(vUv - 0.5);","\tif (aspectCorrection) {","\t\tq.x *= aspect;","\t}","\tq /= scale;","\tq -= offset;","\tfloat dst = length(q);","\tdst = smoothstep(smooth.x, smooth.y, dst);","\tvec3 color = mix(color1, color2, dst);","","\tif (noiseAlpha > 0.0 && grainScale > 0.0) {","\t\tfloat gSize = 1.0 / grainScale;","\t\tfloat g = grain(vUv, vec2(gSize * aspect, gSize), grainTime);","\t\tvec3 noiseColor = blend(color, vec3(g));","\t\tgl_FragColor.rgb = mix(color, noiseColor, noiseAlpha);","\t} else {","\t\tgl_FragColor.rgb = color;","\t}","\tgl_FragColor.a = 1.0;","}"].join("\n");return t.vignettes={createBackground:function(t){var r=(t=t||{}).geometry||new e.PlaneGeometry(2,2,1),a=new e.RawShaderMaterial({vertexShader:n,fragmentShader:i,side:e.DoubleSide,uniforms:{aspectCorrection:{type:"i",value:!1},aspect:{type:"f",value:1},grainScale:{type:"f",value:.005},grainTime:{type:"f",value:0},noiseAlpha:{type:"f",value:.25},offset:{type:"v2",value:new e.Vector2(0,0)},scale:{type:"v2",value:new e.Vector2(1,1)},smooth:{type:"v2",value:new e.Vector2(0,1)},color1:{type:"c",value:new e.Color("#fff")},color2:{type:"c",value:new e.Color("#283844")}},depthTest:!1}),s=new e.Mesh(r,a);s.frustumCulled=!1,s.style=function(t){if(t=t||{},Array.isArray(t.colors)){var n=t.colors.map(function(t){return"string"==typeof t||"number"==typeof t?new e.Color(t):t});a.uniforms.color1.value.copy(n[0]),a.uniforms.color2.value.copy(n[1])}if("number"==typeof t.aspect&&(a.uniforms.aspect.value=t.aspect),"number"==typeof t.grainScale&&(a.uniforms.grainScale.value=t.grainScale),"number"==typeof t.grainTime&&(a.uniforms.grainTime.value=t.grainTime),t.smooth){var i=o(t.smooth,e.Vector2);a.uniforms.smooth.value.copy(i)}if(t.offset){var r=o(t.offset,e.Vector2);a.uniforms.offset.value.copy(r)}if("number"==typeof t.noiseAlpha&&(a.uniforms.noiseAlpha.value=t.noiseAlpha),void 0!==t.scale){var s=t.scale;"number"==typeof s&&(s=[s,s]),s=o(s,e.Vector2),a.uniforms.scale.value.copy(s)}void 0!==t.aspectCorrection&&(a.uniforms.aspectCorrection.value=Boolean(t.aspectCorrection))},t&&s.style(t);return s;function o(e,t){return Array.isArray(e)?(new t).fromArray(e):e}}}}),t("skylark-threegltfviewer/Viewer",["skylark-threejs","skylark-threejs-ex/utils/stats","skylark-threejs-ex/loaders/GLTFLoader","skylark-threejs-ex/loaders/DRACOLoader","skylark-threejs-ex/controls/OrbitControls","skylark-threejs-ex/loaders/RGBELoader","skylark-datgui","./threegltviewer","./environments","./vignettes"],function(t,n,i,r,a,s,o,l,h,d){"use strict";const p="[default]",m=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,u=["map","aoMap","emissiveMap","glossinessMap","metalnessMap","normalMap","roughnessMap","specularMap"],f={ASSET_GENERATOR:"assetgenerator"};t.Cache.enabled=!0;function v(e,t){e.traverse(e=>{if(!e.isMesh)return;const n=Array.isArray(e.material)?e.material:[e.material];n.forEach(t)})}return class{constructor(e,i){this.el=e,this.options=i,this.lights=[],this.content=null,this.mixer=null,this.clips=[],this.gui=null,this.state={environment:i.preset===f.ASSET_GENERATOR?h.find(e=>"footprint-court"===e.id).name:h[1].name,background:!1,playbackSpeed:1,actionStates:{},camera:p,wireframe:!1,skeleton:!1,grid:!1,addLights:!0,exposure:1,textureEncoding:"sRGB",ambientIntensity:.3,ambientColor:16777215,directIntensity:.8*Math.PI,directColor:16777215,bgColor1:"#ffffff",bgColor2:"#353535"},this.prevTime=0,this.stats=new n,this.stats.dom.height="48px",[].forEach.call(this.stats.dom.children,e=>e.style.display=""),this.scene=new t.Scene;const r=i.preset===f.ASSET_GENERATOR?144/Math.PI:60;this.defaultCamera=new t.PerspectiveCamera(r,e.clientWidth/e.clientHeight,.01,1e3),this.activeCamera=this.defaultCamera,this.scene.add(this.defaultCamera),this.renderer=window.renderer=new t.WebGLRenderer({antialias:!0}),this.renderer.physicallyCorrectLights=!0,this.renderer.outputEncoding=t.sRGBEncoding,this.renderer.setClearColor(13421772),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(e.clientWidth,e.clientHeight),this.pmremGenerator=new t.PMREMGenerator(this.renderer),this.pmremGenerator.compileEquirectangularShader(),this.controls=new a(this.defaultCamera,this.renderer.domElement),this.controls.autoRotate=!1,this.controls.autoRotateSpeed=-10,this.controls.screenSpacePanning=!0,this.vignette=d.createBackground({aspect:this.defaultCamera.aspect,grainScale:m?0:.001,colors:[this.state.bgColor1,this.state.bgColor2]}),this.vignette.name="Vignette",this.vignette.renderOrder=-1,this.el.appendChild(this.renderer.domElement),this.cameraCtrl=null,this.cameraFolder=null,this.animFolder=null,this.animCtrls=[],this.morphFolder=null,this.morphCtrls=[],this.skeletonHelpers=[],this.gridHelper=null,this.axesHelper=null,this.addAxesHelper(),this.addGUI(),i.kiosk&&this.gui.close(),this.animate=this.animate.bind(this),requestAnimationFrame(this.animate),window.addEventListener("resize",this.resize.bind(this),!1)}animate(e){requestAnimationFrame(this.animate);const t=(e-this.prevTime)/1e3;this.controls.update(),this.stats.update(),this.mixer&&this.mixer.update(t),this.render(),this.prevTime=e}render(){this.renderer.render(this.scene,this.activeCamera),this.state.grid&&(this.axesCamera.position.copy(this.defaultCamera.position),this.axesCamera.lookAt(this.axesScene.position),this.axesRenderer.render(this.axesScene,this.axesCamera))}resize(){const{clientHeight:e,clientWidth:t}=this.el.parentElement;this.defaultCamera.aspect=t/e,this.defaultCamera.updateProjectionMatrix(),this.vignette.style({aspect:this.defaultCamera.aspect}),this.renderer.setSize(t,e),this.axesCamera.aspect=this.axesDiv.clientWidth/this.axesDiv.clientHeight,this.axesCamera.updateProjectionMatrix(),this.axesRenderer.setSize(this.axesDiv.clientWidth,this.axesDiv.clientHeight)}load(e,n,i){const r=t.LoaderUtils.extractUrlBase(e);return new Promise((a,s)=>{const o=new t.LoadingManager;o.setURLModifier((e,t)=>{const a=n+decodeURI(e).replace(r,"").replace(/^(\.?\/)/,"");if(i.has(a)){const e=i.get(a),t=URL.createObjectURL(e);return d.push(t),t}return(t||"")+e});const l=new b.GLTFLoader(o);l.setCrossOrigin("anonymous");const h=new c.DRACOLoader;h.setDecoderPath("assets/draco/"),l.setDRACOLoader(h);const d=[];l.load(e,e=>{const t=e.scene||e.scenes[0],n=e.animations||[];if(!t)throw new Error("This model contains no scene, and cannot be viewed here. However, it may contain individual 3D resources.");this.setContent(t,n),d.forEach(URL.revokeObjectURL),a(e)},void 0,s)})}setContent(e,n){this.clear();const i=(new t.Box3).setFromObject(e),r=i.getSize(new t.Vector3).length(),a=i.getCenter(new t.Vector3);this.controls.reset(),e.position.x+=e.position.x-a.x,e.position.y+=e.position.y-a.y,e.position.z+=e.position.z-a.z,this.controls.maxDistance=10*r,this.defaultCamera.near=r/100,this.defaultCamera.far=100*r,this.defaultCamera.updateProjectionMatrix(),this.options.cameraPosition?(this.defaultCamera.position.fromArray(this.options.cameraPosition),this.defaultCamera.lookAt(new t.Vector3)):(this.defaultCamera.position.copy(a),this.defaultCamera.position.x+=r/2,this.defaultCamera.position.y+=r/5,this.defaultCamera.position.z+=r/2,this.defaultCamera.lookAt(a)),this.setCamera(p),this.axesCamera.position.copy(this.defaultCamera.position),this.axesCamera.lookAt(this.axesScene.position),this.axesCamera.near=r/100,this.axesCamera.far=100*r,this.axesCamera.updateProjectionMatrix(),this.axesCorner.scale.set(r,r,r),this.controls.saveState(),this.scene.add(e),this.content=e,this.state.addLights=!0,this.content.traverse(e=>{e.isLight?this.state.addLights=!1:e.isMesh&&(e.material.depthWrite=!e.material.transparent)}),this.setClips(n),this.updateLights(),this.updateGUI(),this.updateEnvironment(),this.updateTextureEncoding(),this.updateDisplay(),window.content=this.content,console.info("[glTF Viewer] THREE.Scene exported as `window.content`."),this.printGraph(this.content)}printGraph(e){console.group(" <"+e.type+"> "+e.name),e.children.forEach(e=>this.printGraph(e)),console.groupEnd()}setClips(e){this.mixer&&(this.mixer.stopAllAction(),this.mixer.uncacheRoot(this.mixer.getRoot()),this.mixer=null),this.clips=e,e.length&&(this.mixer=new t.AnimationMixer(this.content))}playAllClips(){this.clips.forEach(e=>{this.mixer.clipAction(e).reset().play(),this.state.actionStates[e.name]=!0})}setCamera(e){e===p?(this.controls.enabled=!0,this.activeCamera=this.defaultCamera):(this.controls.enabled=!1,this.content.traverse(t=>{t.isCamera&&t.name===e&&(this.activeCamera=t)}))}updateTextureEncoding(){const e="sRGB"===this.state.textureEncoding?t.sRGBEncoding:t.LinearEncoding;v(this.content,t=>{t.map&&(t.map.encoding=e),t.emissiveMap&&(t.emissiveMap.encoding=e),(t.map||t.emissiveMap)&&(t.needsUpdate=!0)})}updateLights(){const e=this.state,t=this.lights;e.addLights&&!t.length?this.addLights():!e.addLights&&t.length&&this.removeLights(),this.renderer.toneMappingExposure=e.exposure,2===t.length&&(t[0].intensity=e.ambientIntensity,t[0].color.setHex(e.ambientColor),t[1].intensity=e.directIntensity,t[1].color.setHex(e.directColor))}addLights(){const e=this.state;if(this.options.preset===f.ASSET_GENERATOR){const e=new t.HemisphereLight;return e.name="hemi_light",this.scene.add(e),void this.lights.push(e)}const n=new t.AmbientLight(e.ambientColor,e.ambientIntensity);n.name="ambient_light",this.defaultCamera.add(n);const i=new t.DirectionalLight(e.directColor,e.directIntensity);i.position.set(.5,0,.866),i.name="main_light",this.defaultCamera.add(i),this.lights.push(n,i)}removeLights(){this.lights.forEach(e=>e.parent.remove(e)),this.lights.length=0}updateEnvironment(){const e=g.environments.filter(e=>e.name===this.state.environment)[0];this.getCubeMapTexture(e).then(({envMap:e})=>{e&&this.state.background||this.activeCamera!==this.defaultCamera?this.scene.remove(this.vignette):this.scene.add(this.vignette),this.scene.environment=e,this.scene.background=this.state.background?e:null})}getCubeMapTexture(n){const{path:i}=n;return i?new Promise((n,r)=>{(new e.RGBELoader).setDataType(t.UnsignedByteType).load(i,e=>{const t=this.pmremGenerator.fromEquirectangular(e).texture;this.pmremGenerator.dispose(),n({envMap:t})},void 0,r)}):Promise.resolve({envMap:null})}updateDisplay(){this.skeletonHelpers.length&&this.skeletonHelpers.forEach(e=>this.scene.remove(e)),v(this.content,e=>{e.wireframe=this.state.wireframe}),this.content.traverse(e=>{if(e.isMesh&&e.skeleton&&this.state.skeleton){const n=new t.SkeletonHelper(e.skeleton.bones[0].parent);n.material.linewidth=3,this.scene.add(n),this.skeletonHelpers.push(n)}}),this.state.grid!==Boolean(this.gridHelper)&&(this.state.grid?(this.gridHelper=new t.GridHelper,this.axesHelper=new t.AxesHelper,this.axesHelper.renderOrder=999,this.axesHelper.onBeforeRender=(e=>e.clearDepth()),this.scene.add(this.gridHelper),this.scene.add(this.axesHelper)):(this.scene.remove(this.gridHelper),this.scene.remove(this.axesHelper),this.gridHelper=null,this.axesHelper=null,this.axesRenderer.clear()))}updateBackground(){this.vignette.style({colors:[this.state.bgColor1,this.state.bgColor2]})}addAxesHelper(){this.axesDiv=document.createElement("div"),this.el.appendChild(this.axesDiv),this.axesDiv.classList.add("axes");const{clientWidth:e,clientHeight:n}=this.axesDiv;this.axesScene=new t.Scene,this.axesCamera=new t.PerspectiveCamera(50,e/n,.1,10),this.axesScene.add(this.axesCamera),this.axesRenderer=new t.WebGLRenderer({alpha:!0}),this.axesRenderer.setPixelRatio(window.devicePixelRatio),this.axesRenderer.setSize(this.axesDiv.clientWidth,this.axesDiv.clientHeight),this.axesCamera.up=this.defaultCamera.up,this.axesCorner=new t.AxesHelper(5),this.axesScene.add(this.axesCorner),this.axesDiv.appendChild(this.axesRenderer.domElement)}addGUI(){const e=this.gui=new o({autoPlace:!1,width:260,hideable:!0}),n=e.addFolder("Display"),i=n.add(this.state,"background");i.onChange(()=>this.updateEnvironment());const r=n.add(this.state,"wireframe");r.onChange(()=>this.updateDisplay());const a=n.add(this.state,"skeleton");a.onChange(()=>this.updateDisplay());const s=n.add(this.state,"grid");s.onChange(()=>this.updateDisplay()),n.add(this.controls,"autoRotate"),n.add(this.controls,"screenSpacePanning");const l=n.addColor(this.state,"bgColor1"),c=n.addColor(this.state,"bgColor2");l.onChange(()=>this.updateBackground()),c.onChange(()=>this.updateBackground());const h=e.addFolder("Lighting"),d=h.add(this.state,"textureEncoding",["sRGB","Linear"]);d.onChange(()=>this.updateTextureEncoding()),h.add(this.renderer,"outputEncoding",{sRGB:t.sRGBEncoding,Linear:t.LinearEncoding}).onChange(()=>{this.renderer.outputEncoding=Number(this.renderer.outputEncoding),v(this.content,e=>{e.needsUpdate=!0})});const p=h.add(this.state,"environment",g.environments.map(e=>e.name));p.onChange(()=>this.updateEnvironment()),[h.add(this.state,"exposure",0,2),h.add(this.state,"addLights").listen(),h.add(this.state,"ambientIntensity",0,2),h.addColor(this.state,"ambientColor"),h.add(this.state,"directIntensity",0,4),h.addColor(this.state,"directColor")].forEach(e=>e.onChange(()=>this.updateLights())),this.animFolder=e.addFolder("Animation"),this.animFolder.domElement.style.display="none";const m=this.animFolder.add(this.state,"playbackSpeed",0,1);m.onChange(e=>{this.mixer&&(this.mixer.timeScale=e)}),this.animFolder.add({playAll:()=>this.playAllClips()},"playAll"),this.morphFolder=e.addFolder("Morph Targets"),this.morphFolder.domElement.style.display="none",this.cameraFolder=e.addFolder("Cameras"),this.cameraFolder.domElement.style.display="none";const u=e.addFolder("Performance"),f=document.createElement("li");this.stats.dom.style.position="static",f.appendChild(this.stats.dom),f.classList.add("gui-stats"),u.__ul.appendChild(f);const y=document.createElement("div");this.el.appendChild(y),y.classList.add("gui-wrap"),y.appendChild(e.domElement),e.open()}updateGUI(){this.cameraFolder.domElement.style.display="none",this.morphCtrls.forEach(e=>e.remove()),this.morphCtrls.length=0,this.morphFolder.domElement.style.display="none",this.animCtrls.forEach(e=>e.remove()),this.animCtrls.length=0,this.animFolder.domElement.style.display="none";const e=[],t=[];if(this.content.traverse(n=>{n.isMesh&&n.morphTargetInfluences&&t.push(n),n.isCamera&&(n.name=n.name||`VIEWER__camera_${e.length+1}`,e.push(n.name))}),e.length){this.cameraFolder.domElement.style.display="",this.cameraCtrl&&this.cameraCtrl.remove();const t=[p].concat(e);this.cameraCtrl=this.cameraFolder.add(this.state,"camera",t),this.cameraCtrl.onChange(e=>this.setCamera(e))}if(t.length&&(this.morphFolder.domElement.style.display="",t.forEach(e=>{if(e.morphTargetInfluences.length){const t=this.morphFolder.add({name:e.name||"Untitled"},"name");this.morphCtrls.push(t)}for(let t=0;t<e.morphTargetInfluences.length;t++){const n=this.morphFolder.add(e.morphTargetInfluences,t,0,1,.01).listen();Object.keys(e.morphTargetDictionary).forEach(i=>{i&&e.morphTargetDictionary[i]===t&&n.name(i)}),this.morphCtrls.push(n)}})),this.clips.length){this.animFolder.domElement.style.display="";const e=this.state.actionStates={};this.clips.forEach((t,n)=>{let i;0===n?(e[t.name]=!0,(i=this.mixer.clipAction(t)).play()):e[t.name]=!1;const r=this.animFolder.add(e,t.name).listen();r.onChange(e=>{(i=i||this.mixer.clipAction(t)).setEffectiveTimeScale(1),e?i.play():i.stop()}),this.animCtrls.push(r)})}}clear(){this.content&&(this.scene.remove(this.content),this.content.traverse(e=>{e.isMesh&&e.geometry.dispose()}),v(this.content,e=>{u.forEach(t=>{e[t]&&e[t].dispose()})}))}}}),t("skylark-threegltfviewer/SimpleDropzone",["skylark-langx-emitter","skylark-jszip","./threegltviewer"],function(e,t,n){return n.SimpleDropzone=class{constructor(e,t){this.el=e,this.inputEl=t,this.listeners={drop:[],dropstart:[],droperror:[]},this._onDragover=this._onDragover.bind(this),this._onDrop=this._onDrop.bind(this),this._onSelect=this._onSelect.bind(this),e.addEventListener("dragover",this._onDragover,!1),e.addEventListener("drop",this._onDrop,!1),t.addEventListener("change",this._onSelect)}on(e,t){return this.listeners[e].push(t),this}_emit(e,t){return this.listeners[e].forEach(e=>e(t)),this}destroy(){const e=this.el,t=this.inputEl;e.removeEventListener(this._onDragover),e.removeEventListener(this._onDrop),t.removeEventListener(this._onSelect),delete this.el,delete this.inputEl,delete this.listeners}_onDrop(e){let t;if(e.stopPropagation(),e.preventDefault(),this._emit("dropstart"),e.dataTransfer.items)t=[].slice.call(e.dataTransfer.items).map(e=>e.webkitGetAsEntry());else if(1===(e.dataTransfer.files||[]).length){const t=e.dataTransfer.files[0];return this._isZip(t)?void this._loadZip(t):void this._emit("drop",{files:new Map([[t.name,t]])})}t||this._fail("Required drag-and-drop APIs are not supported in this browser."),1===t.length&&t[0].name.match(/\.zip$/)?t[0].file(e=>this._loadZip(e)):this._loadNextEntry(new Map,t)}_onDragover(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}_onSelect(e){this._emit("dropstart");const t=[].slice.call(this.inputEl.files);if(1===t.length&&this._isZip(t[0]))return void this._loadZip(t[0]);const n=new Map;t.forEach(e=>n.set(e.name,e)),this._emit("drop",{files:n})}_loadNextEntry(e,t){const n=t.pop();if(n)if(n.isFile)n.file(i=>{e.set(n.fullPath,i),this._loadNextEntry(e,t)},()=>console.error("Could not load file: %s",n.fullPath));else if(n.isDirectory){const i=n.createReader(),r=n=>{n.length?(t=t.concat(n),i.readEntries(r)):this._loadNextEntry(e,t)};i.readEntries(r)}else console.warn("Unknown asset type: "+n.fullPath),this._loadNextEntry(e,t);else this._emit("drop",{files:e})}_loadZip(e){const t=new Map;ZipLoader.unzip(e).then(n=>{Object.keys(n.files).forEach(e=>{if(e.match(/\/$/))return;const i=e.replace(/^.*[\\\/]/,"");t.set(e,new File([n.files[e].buffer],i))}),this._emit("drop",{files:t,archive:e})})}_isZip(e){return"application/zip"===e.type||e.name.match(/\.zip$/)}_fail(e){this._emit("droperror",{message:e})}}}),t("skylark-threegltfviewer/App",["skylark-threejs-ex/WebGL","./threegltviewer","./Viewer","./SimpleDropzone"],function(e,t,n,i){"use strict";return t.App=class{constructor(e,t){const n={};this.options={kiosk:Boolean(n.kiosk),model:n.model||"",preset:n.preset||"",cameraPosition:n.cameraPosition?n.cameraPosition.split(",").map(Number):null},this.el=e,this.viewer=null,this.viewerEl=null,this.spinnerEl=e.querySelector(".spinner"),this.dropEl=e.querySelector(".dropzone"),this.inputEl=e.querySelector("#file-input"),this.createDropzone(),this.hideSpinner();const i=this.options;if(i.kiosk){const e=document.querySelector("header");e.style.display="none"}i.model&&this.view(i.model,"",new Map)}createDropzone(){const e=new i(this.dropEl,this.inputEl);e.on("drop",({files:e})=>this.load(e)),e.on("dropstart",()=>this.showSpinner()),e.on("droperror",()=>this.hideSpinner())}createViewer(){return this.viewerEl=document.createElement("div"),this.viewerEl.classList.add("viewer"),this.dropEl.innerHTML="",this.dropEl.appendChild(this.viewerEl),this.viewer=new n(this.viewerEl,this.options),this.viewer}load(e){let t,n;Array.from(e).forEach(([e,i])=>{i.name.match(/\.(gltf|glb)$/)&&(t=i,n=e.replace(i.name,""))}),t||this.onError("No .gltf or .glb asset found."),this.view(t,n,e)}view(e,t,n){this.viewer&&this.viewer.clear();const i=this.viewer||this.createViewer(),r="string"==typeof e?e:URL.createObjectURL(e),a=()=>{this.hideSpinner(),"object"==typeof e&&URL.revokeObjectURL(r)};i.load(r,t,n).catch(e=>this.onError(e)).then(e=>{a()})}onError(e){let t=(e||{}).message||e.toString();t.match(/ProgressEvent/)?t="Unable to retrieve this file. Check JS console and browser network tab.":t.match(/Unexpected token/)?t=`Unable to parse file content. Verify that this file is valid. Error: "${t}"`:e&&e.target&&e.target instanceof Image&&(t="Missing texture: "+e.target.src.split("/").pop()),window.alert(t),console.error(e)}showSpinner(){this.spinnerEl.style.display=""}hideSpinner(){this.spinnerEl.style.display="none"}}}),t("skylark-threegltfviewer/main",["./threegltviewer","./App"],function(e){return e}),t("skylark-threegltfviewer",["skylark-threegltfviewer/main"],function(e){return e})}(i),!r){var o=require("skylark-langx-ns");a?module.exports=o:n.skylarkjs=o}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-threegltfviewer.js.map
