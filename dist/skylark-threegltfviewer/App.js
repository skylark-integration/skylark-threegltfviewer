/**
 * skylark-threegltfviewer - A version of threegltfviewer that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-threegltfviewer/
 * @license MIT
 */
define(["skylark-threejs-ex/WebGL","./threegltviewer","./Viewer","./SimpleDropzone"],function(e,t,i,r){"use strict";return t.App=class{constructor(e,t){const i={};this.options={kiosk:Boolean(i.kiosk),model:i.model||"",preset:i.preset||"",cameraPosition:i.cameraPosition?i.cameraPosition.split(",").map(Number):null},this.el=e,this.viewer=null,this.viewerEl=null,this.spinnerEl=e.querySelector(".spinner"),this.dropEl=e.querySelector(".dropzone"),this.inputEl=e.querySelector("#file-input"),this.createDropzone(),this.hideSpinner();const r=this.options;r.kiosk&&(document.querySelector("header").style.display="none"),r.model&&this.view(r.model,"",new Map)}createDropzone(){const e=new r(this.dropEl,this.inputEl);e.on("drop",({files:e})=>this.load(e)),e.on("dropstart",()=>this.showSpinner()),e.on("droperror",()=>this.hideSpinner())}createViewer(){return this.viewerEl=document.createElement("div"),this.viewerEl.classList.add("viewer"),this.dropEl.innerHTML="",this.dropEl.appendChild(this.viewerEl),this.viewer=new i(this.viewerEl,this.options),this.viewer}load(e){let t,i;Array.from(e).forEach(([e,r])=>{r.name.match(/\.(gltf|glb)$/)&&(t=r,i=e.replace(r.name,""))}),t||this.onError("No .gltf or .glb asset found."),this.view(t,i,e)}view(e,t,i){this.viewer&&this.viewer.clear();const r=this.viewer||this.createViewer(),s="string"==typeof e?e:URL.createObjectURL(e),o=()=>{this.hideSpinner(),"object"==typeof e&&URL.revokeObjectURL(s)};r.load(s,t,i).catch(e=>this.onError(e)).then(e=>{o()})}onError(e){let t=(e||{}).message||e.toString();t.match(/ProgressEvent/)?t="Unable to retrieve this file. Check JS console and browser network tab.":t.match(/Unexpected token/)?t=`Unable to parse file content. Verify that this file is valid. Error: "${t}"`:e&&e.target&&e.target instanceof Image&&(t="Missing texture: "+e.target.src.split("/").pop()),window.alert(t),console.error(e)}showSpinner(){this.spinnerEl.style.display=""}hideSpinner(){this.spinnerEl.style.display="none"}}});
//# sourceMappingURL=sourcemaps/App.js.map
